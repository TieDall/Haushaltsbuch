<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Haushaltsbuch</title>
        
        <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" type="text/css" href="css/sharedstyle.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="css/dashboardstyle.css" media="screen" />
	<script src="js/functions.js"></script>
        
        <link rel="stylesheet" href="css/bootstrap.min.css" />
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script> 
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"></link>
    </h:head>
    <h:body onload="currentMonth();">
        <div class="topnav" id="myTopnav">
            <a href="index.xhtml" class="active">Dashboard</a>
            <a class="section1" data-toggle="collapse" data-target="#adding_collapse_mobile">Erfassung</a>		
            <div id="adding_collapse_mobile" class="collapse">
                <a href="" class="section2">- Einnahme</a>
                <a href="" class="section2">- Ausgabe</a>
            </div> 
            <a class="section1" data-toggle="collapse" data-target="#overview_collapse_mobile">Übersicht</a>
            <div id="overview_collapse_mobile" class="collapse">
                <a href="list.xhtml" class="section2">- Listen</a>
                <a href="trend.xhtml" class="section2">- Verlauf</a>
            </div> 
            <a href="" class="section1" data-toggle="modal" data-target="#fixpaymentsModal" onclick="modal('fixpayments', 'fixincome', 'fixoutcome');" >Fixe Zahlungen</a>
            <a href="export.xhtml" class="section1">Export</a>
            <a href="javascript:void(0);" class="icon" onclick="respNav()">
                <i class="fa fa-bars"></i>
            </a>
        </div>
        <div id="nav">
            <img src="img/logo.svg" />
            <a href="index.xhtml" class="section1">Dashboard</a>
            <a class="section1" data-toggle="collapse" data-target="#adding_collapse">Erfassung</a>		
            <div id="adding_collapse" class="collapse">
                <a href="" class="section2">Einnahme</a>
                <a href="" class="section2">Ausgabe</a>
            </div> 
            <a class="section1" data-toggle="collapse" data-target="#overview_collapse">Übersicht</a>
            <div id="overview_collapse" class="collapse">
                <a href="list.xhtml" class="section2">Listen</a>
                <a href="trend.xhtml" class="section2">Verlauf</a>
            </div>
            <a href="" class="section1" data-toggle="modal" data-target="#fixpaymentsModal" onclick="modal('fixpayments', 'fixincome', 'fixoutcome');" >Fixe Zahlungen</a>
            <a href="export.xhtml" class="section1">Export</a>
	</div>
	<div id="header">
            <h1>Haushaltsbuch</h1>
	</div>
	<div id="content">
		<div id="overview" class="panel panel-default">
                    <div class="panel panel-heading">aktueller Monat: <span id="currentMonth"></span></div>
			<div class="panel panel-body">
                            <div class="css_bar_graph">
                                <!-- graph -->
                                <div class="graph">
                                    <!-- grid -->
                                    <ul class="grid">
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                        <li class="bottom"></li>
                                    </ul>
                                    <!-- bars -->
                                    <!-- 250px = 100% -->
                                    <ul>
                                        <li id="income_bar" class="bar nr_1 green" style="height: #{master.heightIncome}px;">
                                            <div class="top"></div>
                                            <div class="bottom"></div>
                                            <span>
                                                <h:outputText value="#{master.sumIncome}">
                                                    <f:convertNumber groupingUsed="true" minFractionDigits="2"/>
                                                </h:outputText>€
                                            </span>
                                        </li>
                                        <li id="outcome_bar" class="bar nr_2 red" style="height: #{master.heightOutcome}px;">
                                            <div class="top"></div>
                                            <div class="bottom"></div>
                                            <span>
                                                <h:outputText value="#{master.sumOutcome}">
                                                    <f:convertNumber groupingUsed="true" minFractionDigits="2"/>
                                                </h:outputText>€
                                            </span>
                                        </li>
                                    </ul>	
                                </div>
                            </div>
                            <div id="additionalInfo">
                                <p id="income_label">Einnahmen</p>
                                <p id="outcome_label">Ausgaben</p>
                                <br/>
                                <p id="bilanz">Bilanz: 
                                    <span id="#{master.balanceCss}">
                                        <h:outputText value="#{master.balance}">
                                            <f:convertNumber groupingUsed="true" minFractionDigits="2"/>
                                        </h:outputText>€
                                    </span>
                                </p>
                            </div>
			</div>
		</div>
		<div id="list" class="panel panel-default">
			<div class="panel-heading">
				Zuletzt erfasste Ausgaben:
			</div>
			<div class="table-responsive panel-body">
                                
                            <button style="width:100%" type="button" onclick="modal('payments', 'income', 'outcome')" class="btn btn-info btn-lg" data-toggle="modal" data-target="#addingModal">Hinzufügen</button>
				<h:dataTable value="#{master.listLastTen}" var="pay" 
                                                styleClass="table-hover table">
                                        <h:column>
                                                <f:facet name = "header">Datum</f:facet>    				
                                                <h:outputText value="#{pay.created}">
                                                    <f:convertDateTime pattern="dd.MM.yyyy" />
                                                </h:outputText>
                                        </h:column>
                                        <h:column>
                                                <f:facet name = "header">Kategorie</f:facet>
                                                #{pay.category.name}
                                        </h:column>
                                        <h:column>
                                                <f:facet name = "header">Betrag</f:facet>    				
                                                <ui:fragment rendered="#{!pay.category.isIncome}">
                                                <h:outputText style="color: red" value="#{pay.amount}">
                                                    <f:convertNumber groupingUsed="true" minFractionDigits="2"/>
                                                </h:outputText> <span style="color: red"> € </span>
                                                </ui:fragment>
                                                <ui:fragment rendered="#{pay.category.isIncome}">
                                                <h:outputText style="color: yellowgreen" value="#{pay.amount}">
                                                    <f:convertNumber groupingUsed="true" minFractionDigits="2"/>
                                                </h:outputText> <span style="color: yellowgreen"> € </span>
                                                </ui:fragment>
                                        </h:column>
                                </h:dataTable>
			</div>
		</div>
	</div>
	<div id="footer">
            <p>Version: 0.1</p>
	</div>
        
        <!-- 
        ===== MODALS ====
        -->
	
	<div id="addingModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Erfassung</h4>
                    </div>
                    <div class="modal-body">
                        <h:form>
                            <fieldset> 
                                <table width="100%">
                                    <tr>
                                        <td>
                                            <input type="radio" onclick="income('income', 'outcome')" id="in" value="income" name="payments" checked="checked"/> 
                                            <label for="in">Einnahme</label>
                                        </td>
                                        <td>
                                            <input type="radio" onclick="outcome('outcome', 'income')" id="out" value="outcome" name="payments" /> 
                                            <label for="out">Ausgabe</label>
                                        </td>
                                    </tr>
                                </table>
                            </fieldset>
                            <div>
                                <div id="income">
                                    <fieldset> 
                                        <table width="100%">
                                            <tr>
                                                <td>
                                                    <p>Kategorie:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.categoriesIncome}" var="c"
                                                                       itemLabel="#{c.name}" itemValue="#{c.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingKategorieEinnahme">Hinzufügen</button>
                                                </td>                                     
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Betrag:</p>
                                                </td>
                                                <td>
                                                    <input type="number" id="Betrag" name="Betrag" step="0.01"></input> €
                                                </td>                                        
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Person:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.person}" var="p"
                                                                       itemLabel="#{p.name}" itemValue="#{p.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingPerson">Hinzufügen</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Notiz:</p>
                                                </td>
                                                <td>
                                                    <textarea id="Notiz" name="Notiz" cols="35" rows="4"></textarea>
                                                </td>                                        
                                            </tr>
                                            <tr><td><button type="button">Hinzufügen</button></td></tr>
                                        </table>
                                    </fieldset>
                                </div>
                                <div id="outcome">
                                    <fieldset> 
                                        <table width="100%">
                                            <tr>
                                                <td>
                                                    <p>Kategorie:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.categoriesOutcome}" var="c"
                                                                       itemLabel="#{c.name}" itemValue="#{c.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingKategorieAusgabe">Hinzufügen</button>
                                                </td>                                     
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Betrag:</p>
                                                </td>
                                                <td>
                                                    <input type="number" id="Betrag" name="Betrag" step="0.01"></input> €
                                                </td>                                        
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Person:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.person}" var="p"
                                                                       itemLabel="#{p.name}" itemValue="#{p.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingPerson">Hinzufügen</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Notiz:</p>
                                                </td>
                                                <td>
                                                    <textarea id="Notiz" name="Notiz" cols="35" rows="4"></textarea>
                                                </td>                                        
                                            </tr>
                                            <tr><td><button type="button">Hinzufügen</button></td></tr>
                                        </table>
                                    </fieldset>
                                </div>
                            </div>
                        </h:form>
                    </div>
                </div>
            </div>
	</div>
        <div id="addingKategorieEinnahme" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Kategorie erstellen</h4>
                    </div>
                    <div class="modal-body">
                        <h:form id="Category_income">
                        Name der Kategorie für Einnahmen:
                            <h:inputText id="category_income" binding="#{Category}" />
                            <p:commandButton value = "Hinzufügen" action="#{master.addCategory(Category.value, true)}" onclick="index.xhtml" />
                        </h:form>
                    </div>
                </div>
            </div>
        </div>
        <div id="addingKategorieAusgabe" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Kategorie erstellen</h4>
                    </div>
                    <div class="modal-body">
                        <h:form id="Category_outcome">
                        Name der Kategorie für Einnahmen:
                            <h:inputText id="category_outcome" binding="#{Category}" />
                            <p:commandButton value = "Hinzufügen" action="#{master.addCategory(Category.value, false)}" onclick="index.xhtml" />
                        </h:form>
                    </div>
                </div>
            </div>
        </div>
        <div id="addingPerson" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Person hinzufügen</h4>
                    </div>
                    <div class="modal-body">
                        <h:form id="Person">
                        Name der Person:
                            <h:inputText id="person" binding="#{person}" />
                            <p:commandButton value = "Hinzufügen" action="#{master.addPerson(person.value)}" onclick="index.xhtml" />
                        </h:form>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="fixpaymentsModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Erfassung</h4>
                    </div>
                    <div class="modal-body">
                        <form>
                            <fieldset> 
                                <table width="100%">
                                    <tr>
                                        <td>
                                            <input type="radio" onclick="income('fixincome', 'fixoutcome')" id="in" value="fixincome" name="fixpayments" checked="checked"/> 
                                            <label for="in">Einnahme</label>
                                        </td>
                                        <td>
                                            <input type="radio" onclick="outcome('fixoutcome', 'fixincome')" id="out" value="fixoutcome" name="fixpayments" /> 
                                            <label for="out">Ausgabe</label>
                                        </td>
                                    </tr>
                                </table>
                            </fieldset>
                            <div>
                                <div id="fixincome">
                                    <fieldset> 
                                        <table width="100%">
                                            <tr>
                                                <td>
                                                    <p>Kategorie:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.categoriesIncome}" var="c"
                                                                       itemLabel="#{c.name}" itemValue="#{c.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingKategorieEinnahme">Hinzufügen</button>
                                                </td>                                     
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Häufigkeit</p>
                                                </td>
                                                <td>
                                                    <select>
                                                        <option value="Monatlich">Monatlich</option>
                                                        <option value="Quartal">Quartal</option>
                                                        <option value="Halbjährlich">Halbjährlich</option>
                                                        <option value="Jährlich">Jährlich</option>
                                                    </select>
                                                </td>                                     
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Betrag:</p>
                                                </td>
                                                <td>
                                                    <input type="number" id="Betrag" name="Betrag"></input> €
                                                </td>                                        
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Person:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.person}" var="p"
                                                                       itemLabel="#{p.name}" itemValue="#{p.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingPerson">Hinzufügen</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Notiz:</p>
                                                </td>
                                                <td>
                                                    <textarea id="Notiz" name="Notiz" cols="35" rows="4"></textarea>
                                                </td>                                        
                                            </tr>
                                            <tr><td><button type="button">Hinzufügen</button></td></tr>
                                        </table>
                                    </fieldset>
                                </div>
                                <div id="fixoutcome">
                                    <fieldset> 
                                        <table width="100%">
                                            <tr>
                                                <td>
                                                    <p>Kategorie:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.categoriesOutcome}" var="c"
                                                                       itemLabel="#{c.name}" itemValue="#{c.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingKategorieAusgabe">Hinzufügen</button>
                                                </td>                                     
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Betrag:</p>
                                                </td>
                                                <td>
                                                    <input type="number" id="Betrag" name="Betrag"></input> €
                                                </td>                                        
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Person:</p>
                                                </td>
                                                <td>
                                                    <h:selectOneMenu>
                                                        <f:selectItems value="#{master.person}" var="p"
                                                                       itemLabel="#{p.name}" itemValue="#{p.name}" />
                                                    </h:selectOneMenu>
                                                    <button type="button" data-toggle="modal" data-target="#addingPerson">Hinzufügen</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Notiz:</p>
                                                </td>
                                                <td>
                                                    <textarea id="Notiz" name="Notiz" cols="35" rows="4"></textarea>
                                                </td>                                        
                                            </tr>
                                            <tr><td><button type="button">Hinzufügen</button></td></tr>
                                        </table>
                                    </fieldset>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
	</div>
    </h:body>
</html>

